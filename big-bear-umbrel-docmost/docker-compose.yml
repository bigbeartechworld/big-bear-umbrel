# Configuration for docmost setup
# Name of the big-bear-docmost application
version: "3.7"
# Service definitions for the big-bear-docmost application
services:
  app_proxy:
    environment:
      APP_HOST: _big-bear-docmost_1
      APP_PORT: "3000"
  # Service name: big-bear-docmost
  # The `big-bear-docmost` service definition
  big-bear-docmost:
    # Image to be used for the container
    image: docmost/docmost:0.23.2
    # Container restart policy
    restart: unless-stopped
    environment:
      - APP_URL=http://localhost:3000
      - APP_SECRET=d4e8f3c3-72b9-4003-be4c-168f13024853
      - DATABASE_URL=postgresql://docmost:ea9dee39-c390-4a88-be39-8034f4bb9b82@big-bear-docmost-db:5432/docmost?schema=public
      - REDIS_URL=redis://big-bear-docmost-redis:6379/0
    # Volumes to be mounted to the container
    volumes:
      - ${APP_DATA_DIR}/docmost_data_storage:/app/data/storage
    networks:
      - big-bear-docmost-network
    depends_on:
      - big-bear-docmost-db
      - big-bear-docmost-redis
  big-bear-docmost-db:
    image: postgres:16-alpine
    environment:
      - POSTGRES_DB=docmost
      - POSTGRES_USER=docmost
      - POSTGRES_PASSWORD=ea9dee39-c390-4a88-be39-8034f4bb9b82
    restart: unless-stopped
    volumes:
      - ${APP_DATA_DIR}/docmost_data_pgdata:/var/lib/postgresql/data
    networks:
      - big-bear-docmost-network
  big-bear-docmost-redis:
    image: redis:7.2.11-alpine@sha256:b19a2cb55412c26e0c3725011ac04397eba5cb0d7f090f739cbbce8dc97f8e60
    restart: unless-stopped
    volumes:
      - ${APP_DATA_DIR}/docmost_data_redis:/data
    networks:
      - big-bear-docmost-network
networks:
  big-bear-docmost-network:
    driver: bridge
