version: "3.7"
services:
  big-bear-joplin:
    image: joplin/server:3.4.3
    restart: unless-stopped
    environment:
      - APP_PORT=22300
      - APP_BASE_URL=http://localhost:22300
      - DB_CLIENT=pg
      - POSTGRES_PASSWORD=27a1d42a-a15d-43dd-903c-2a73538647fe
      - POSTGRES_USER=bigbear
      - POSTGRES_DATABASE=joplin
      - POSTGRES_PORT=5432
      - POSTGRES_HOST=big-bear-joplin-db
      - MAX_TIME_DRIFT=0
    networks:
      - big_bear_joplin_network
    depends_on:
      - big-bear-joplin-db
  big-bear-joplin-db:
    image: postgres:14.2
    volumes:
      - ${APP_DATA_DIR}/postgresql/data:/var/lib/postgresql/data
    restart: unless-stopped
    environment:
      - POSTGRES_PASSWORD=27a1d42a-a15d-43dd-903c-2a73538647fe
      - POSTGRES_USER=bigbear
      - POSTGRES_DB=joplin
    networks:
      - big_bear_joplin_network
  app_proxy:
    environment:
      APP_HOST: big-bear-umbrel-joplin_big-bear-joplin_1
      APP_PORT: "22300"
networks:
  big_bear_joplin_network:
    driver: bridge
