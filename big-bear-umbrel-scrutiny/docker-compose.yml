
version: "3.7"
services:
  big-bear-scrutiny:
    image: ghcr.io/analogj/scrutiny:master-omnibus
    restart: unless-stopped
    volumes:
      - ${APP_DATA_DIR}/config:/opt/scrutiny/config
      - ${APP_DATA_DIR}/influxdb:/opt/scrutiny/influxdb
      - /run/udev:/run/udev:ro
    cap_add:
      - SYS_RAWIO
    devices:
      - /dev/sda:/dev/sda
      - /dev/nvme0:/dev/nvme0
    privileged: true
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/api/health"]
      interval: 1m30s
      timeout: 10s
      retries: 3
      start_period: 40s
  app_proxy:
    environment:
      APP_HOST: big-bear-umbrel-scrutiny_big-bear-scrutiny_1
      APP_PORT: "8080"
